{% extends "base.html" %}

{% block title %}Catalog - Remarcable{% endblock %}

{% block content %}
<h1 class="mb-4">Catalog</h1>

<form method="get" class="row g-3 mb-4">
  <!-- Category filter -->
  <div class="col-md-4">
    <label for="category" class="form-label fw-bold">Category</label>
    <select name="category" id="category" class="form-select">
      <option value="">All Categories</option>
      {% for cat in categories %}
        <option value="{{ cat.id }}" {% if selected_category == cat.id|stringformat:"s" %}selected{% endif %}>
          {{ cat.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <!-- Tags filter -->
  <div class="col-md-8">
    <label class="form-label fw-bold">Tags</label><br>
    {% for tag in tags %}
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="tags" value="{{ tag.id }}"
          {% if tag.id|stringformat:"s" in selected_tags %}checked{% endif %}>
        <label class="form-check-label">{{ tag.name }}</label>
      </div>
    {% endfor %}
  </div>

  <div class="col-12">
    <button type="submit" class="btn btn-primary">Filter</button>
    <a href="{% url 'catalog:item_list' %}" class="btn btn-secondary">Reset</a>
  </div>
</form>

<!-- Item list -->
<div class="row">
  {% for item in items %}
    <div class="col-md-4 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">{{ item.name }}</h5>
          <p class="card-text">{{ item.description|truncatewords:20 }}</p>
          <p class="text-muted mb-1"><strong>Category:</strong> {{ item.category.name }}</p>
          <p class="text-muted"><strong>Tags:</strong>
            {% for tag in item.tags.all %}
              <span class="badge bg-info text-dark">{{ tag.name }}</span>
            {% empty %}
              No tags
            {% endfor %}
          </p>
        </div>
      </div>
    </div>
  {% empty %}
    <p>No items found.</p>
  {% endfor %}
</div>
{% endblock %}
